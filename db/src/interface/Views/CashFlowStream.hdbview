view "sap.fsdm.Views::CashFlowStream_View" ( IN I_BUSINESS_DATE DATE, IN I_SYSTEM_TIMESTAMP TIMESTAMP)
as select
      "CashFlowEndDate" as "CashFlowEndDate",
      "CashFlowScenario" as "CashFlowScenario",
      "CashFlowSource" as "CashFlowSource",
      "CashFlowStartDate" as "CashFlowStartDate",
      "CashFlowType" as "CashFlowType",
      "ItemNumber" as "ItemNumber",
      "ASSOC_Contract.FinancialContractID" as "ASSOC_Contract_FinancialContractID",
      "ASSOC_Contract.IDSystem" as "ASSOC_Contract_IDSystem",
      "ASSOC_InterestSpecification.SequenceNumber" as "ASSOC_InterestSpecification_SequenceNumber",
      "ASSOC_InterestSpecification.ASSOC_CcyOfMultiCcyAccnt.PositionCurrency" as "ASSOC_InterestSpecification_ASSOC_CcyOfMultiCcyAccnt_PositionCurrency",
      "ASSOC_InterestSpecification.ASSOC_CcyOfMultiCcyAccnt.ASSOC_MultiCcyAccnt.FinancialContractID" as "ASSOC_InterestSpecification_ASSOC_CcyOfMultiCcyAccnt_ASSOC_MultiCcyAccnt_FinancialContractID",
      "ASSOC_InterestSpecification.ASSOC_CcyOfMultiCcyAccnt.ASSOC_MultiCcyAccnt.IDSystem" as "ASSOC_InterestSpecification_ASSOC_CcyOfMultiCcyAccnt_ASSOC_MultiCcyAccnt_IDSystem",
      "ASSOC_InterestSpecification.ASSOC_FinancialContract.FinancialContractID" as "ASSOC_InterestSpecification_ASSOC_FinancialContract_FinancialContractID",
      "ASSOC_InterestSpecification.ASSOC_FinancialContract.IDSystem" as "ASSOC_InterestSpecification_ASSOC_FinancialContract_IDSystem",
      "ASSOC_InterestSpecification._DebtInstrument.FinancialInstrumentID" as "ASSOC_InterestSpecification__DebtInstrument_FinancialInstrumentID",
      "ASSOC_InterestSpecification._OptionOfReferenceRateSpecification.ComponentNumber" as "ASSOC_InterestSpecification__OptionOfReferenceRateSpecification_ComponentNumber",
      "ASSOC_InterestSpecification._OptionOfReferenceRateSpecification._InterestRateOption.FinancialContractID" as "ASSOC_InterestSpecification__OptionOfReferenceRateSpecification__InterestRateOption_FinancialContractID",
      "ASSOC_InterestSpecification._OptionOfReferenceRateSpecification._InterestRateOption.IDSystem" as "ASSOC_InterestSpecification__OptionOfReferenceRateSpecification__InterestRateOption_IDSystem",
      "ASSOC_InterestSpecification._OptionOfStrikeSpecification.ComponentNumber" as "ASSOC_InterestSpecification__OptionOfStrikeSpecification_ComponentNumber",
      "ASSOC_InterestSpecification._OptionOfStrikeSpecification._InterestRateOption.FinancialContractID" as "ASSOC_InterestSpecification__OptionOfStrikeSpecification__InterestRateOption_FinancialContractID",
      "ASSOC_InterestSpecification._OptionOfStrikeSpecification._InterestRateOption.IDSystem" as "ASSOC_InterestSpecification__OptionOfStrikeSpecification__InterestRateOption_IDSystem",
      "ASSOC_InterestSpecification._Trade.IDSystem" as "ASSOC_InterestSpecification__Trade_IDSystem",
      "ASSOC_InterestSpecification._Trade.TradeID" as "ASSOC_InterestSpecification__Trade_TradeID",
      "ASSOC_PositionCurrencyOfCashFlow.PositionCurrency" as "ASSOC_PositionCurrencyOfCashFlow_PositionCurrency",
      "ASSOC_PositionCurrencyOfCashFlow.ASSOC_MultiCcyAccnt.FinancialContractID" as "ASSOC_PositionCurrencyOfCashFlow_ASSOC_MultiCcyAccnt_FinancialContractID",
      "ASSOC_PositionCurrencyOfCashFlow.ASSOC_MultiCcyAccnt.IDSystem" as "ASSOC_PositionCurrencyOfCashFlow_ASSOC_MultiCcyAccnt_IDSystem",
      "_CollectionOfCashFlow.CollectionID" as "_CollectionOfCashFlow_CollectionID",
      "_CollectionOfCashFlow.IDSystem" as "_CollectionOfCashFlow_IDSystem",
      "_Instrument.FinancialInstrumentID" as "_Instrument_FinancialInstrumentID",
      "BusinessValidFrom" as "BusinessValidFrom",
      "BusinessValidTo" as "BusinessValidTo",
      "SystemValidFrom" as "SystemValidFrom",
      "SystemValidTo" as "SystemValidTo",
      "ASSOC_ReferenceRate.ReferenceRateID" as "ASSOC_ReferenceRate_ReferenceRateID",
      "_FSSubLedgerDocumentItem.CompanyCode" as "_FSSubLedgerDocumentItem_CompanyCode",
      "_FSSubLedgerDocumentItem.DocumentNumber" as "_FSSubLedgerDocumentItem_DocumentNumber",
      "_FSSubLedgerDocumentItem.FiscalYear" as "_FSSubLedgerDocumentItem_FiscalYear",
      "_FSSubLedgerDocumentItem.ItemNumber" as "_FSSubLedgerDocumentItem_ItemNumber",
      "_FSSubLedgerDocumentItem.PostingDate" as "_FSSubLedgerDocumentItem_PostingDate",
      "_FSSubLedgerDocumentItem._AccountingSystem.AccountingSystemID" as "_FSSubLedgerDocumentItem__AccountingSystem_AccountingSystemID",
      "AmountInPositionCurrency" as "AmountInPositionCurrency",
      "AmountInTransactionCurrency" as "AmountInTransactionCurrency",
      "ApplicableInterestRate" as "ApplicableInterestRate",
      "CashFlowCategory" as "CashFlowCategory",
      "CashFlowItemCategory" as "CashFlowItemCategory",
      "CashFlowItemType" as "CashFlowItemType",
      "CurrencyOfPrincipalAmount" as "CurrencyOfPrincipalAmount",
      "DueDate" as "DueDate",
      "InterestFixingDate" as "InterestFixingDate",
      "InterestPeriodEndDate" as "InterestPeriodEndDate",
      "InterestPeriodStartDate" as "InterestPeriodStartDate",
      "InvestmentHoldingNominalAmount" as "InvestmentHoldingNominalAmount",
      "InvestmentHoldingNominalAmountCurrency" as "InvestmentHoldingNominalAmountCurrency",
      "InvestmentHoldingQuantity" as "InvestmentHoldingQuantity",
      "InvestmentHoldingUnit" as "InvestmentHoldingUnit",
      "NumberOfBaseDaysUsedForInterestCalculation" as "NumberOfBaseDaysUsedForInterestCalculation",
      "NumberOfDaysUsedForInterestCalculation" as "NumberOfDaysUsedForInterestCalculation",
      "PositionCurrency" as "PositionCurrency",
      "PostingDirection" as "PostingDirection",
      "PrincipalAmount" as "PrincipalAmount",
      "SettledDate" as "SettledDate",
      "SpreadIncludedInApplicableRate" as "SpreadIncludedInApplicableRate",
      "TradeDate" as "TradeDate",
      "TransactionCurrency" as "TransactionCurrency",
      "UnsignedAmountInPositionCurrency" as "UnsignedAmountInPositionCurrency",
      "UnsignedAmountInTransactionCurrency" as "UnsignedAmountInTransactionCurrency",
      "UsedExchangeRate" as "UsedExchangeRate",
      "ValueDate" as "ValueDate",
      "SourceSystemID" as "SourceSystemID",
      "ChangeTimestampInSourceSystem" as "ChangeTimestampInSourceSystem",
      "ChangingUserInSourceSystem" as "ChangingUserInSourceSystem",
      "ChangingProcessType" as "ChangingProcessType",
      "ChangingProcessID" as "ChangingProcessID"
  
from "sap.fsdm::CashFlowStream"
FOR SYSTEM_TIME AS OF :I_SYSTEM_TIMESTAMP
WHERE "BusinessValidFrom" <= :I_BUSINESS_DATE AND "BusinessValidTo" > :I_BUSINESS_DATE;