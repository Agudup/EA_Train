view "sap.fsdm.Views::NonProportionalCoverageLimitDeductible_View" ( IN I_BUSINESS_DATE DATE, IN I_SYSTEM_TIMESTAMP TIMESTAMP)
as select
      "NonProportionalCoverageLimitDeductableType" as "NonProportionalCoverageLimitDeductableType",
      "_CededRiskCurrency.Currency" as "_CededRiskCurrency_Currency",
      "_CededRiskCurrency._ReinsuranceCoverage.CoverageID" as "_CededRiskCurrency__ReinsuranceCoverage_CoverageID",
      "_CededRiskCurrency._ReinsuranceCoverage.SectionID" as "_CededRiskCurrency__ReinsuranceCoverage_SectionID",
      "_CededRiskCurrency._ReinsuranceCoverage._ReinsuranceContract.FinancialContractID" as "_CededRiskCurrency__ReinsuranceCoverage__ReinsuranceContract_FinancialContractID",
      "_CededRiskCurrency._ReinsuranceCoverage._ReinsuranceContract.IDSystem" as "_CededRiskCurrency__ReinsuranceCoverage__ReinsuranceContract_IDSystem",
      "_ClassOfInsurance.ClassOfInsurance" as "_ClassOfInsurance_ClassOfInsurance",
      "_ClassOfInsurance.SubClassOfInsurance" as "_ClassOfInsurance_SubClassOfInsurance",
      "_ClassOfInsurance.SubSubClassOfInsurance" as "_ClassOfInsurance_SubSubClassOfInsurance",
      "_ClassOfInsurance._ReinsuranceCoverage.CoverageID" as "_ClassOfInsurance__ReinsuranceCoverage_CoverageID",
      "_ClassOfInsurance._ReinsuranceCoverage.SectionID" as "_ClassOfInsurance__ReinsuranceCoverage_SectionID",
      "_ClassOfInsurance._ReinsuranceCoverage._ReinsuranceContract.FinancialContractID" as "_ClassOfInsurance__ReinsuranceCoverage__ReinsuranceContract_FinancialContractID",
      "_ClassOfInsurance._ReinsuranceCoverage._ReinsuranceContract.IDSystem" as "_ClassOfInsurance__ReinsuranceCoverage__ReinsuranceContract_IDSystem",
      "_Peril.Peril" as "_Peril_Peril",
      "_Peril._ReinsuranceCoverage.CoverageID" as "_Peril__ReinsuranceCoverage_CoverageID",
      "_Peril._ReinsuranceCoverage.SectionID" as "_Peril__ReinsuranceCoverage_SectionID",
      "_Peril._ReinsuranceCoverage._ReinsuranceContract.FinancialContractID" as "_Peril__ReinsuranceCoverage__ReinsuranceContract_FinancialContractID",
      "_Peril._ReinsuranceCoverage._ReinsuranceContract.IDSystem" as "_Peril__ReinsuranceCoverage__ReinsuranceContract_IDSystem",
      "_Region.Region" as "_Region_Region",
      "_Region._ReinsuranceCoverage.CoverageID" as "_Region__ReinsuranceCoverage_CoverageID",
      "_Region._ReinsuranceCoverage.SectionID" as "_Region__ReinsuranceCoverage_SectionID",
      "_Region._ReinsuranceCoverage._ReinsuranceContract.FinancialContractID" as "_Region__ReinsuranceCoverage__ReinsuranceContract_FinancialContractID",
      "_Region._ReinsuranceCoverage._ReinsuranceContract.IDSystem" as "_Region__ReinsuranceCoverage__ReinsuranceContract_IDSystem",
      "BusinessValidFrom" as "BusinessValidFrom",
      "BusinessValidTo" as "BusinessValidTo",
      "SystemValidFrom" as "SystemValidFrom",
      "SystemValidTo" as "SystemValidTo",
      "Category" as "Category",
      "EndDate" as "EndDate",
      "MaximumAmount" as "MaximumAmount",
      "MinimumAmount" as "MinimumAmount",
      "Percent" as "Percent",
      "ReferenceBasis" as "ReferenceBasis",
      "StartDate" as "StartDate",
      "SourceSystemID" as "SourceSystemID",
      "ChangeTimestampInSourceSystem" as "ChangeTimestampInSourceSystem",
      "ChangingUserInSourceSystem" as "ChangingUserInSourceSystem",
      "ChangingProcessType" as "ChangingProcessType",
      "ChangingProcessID" as "ChangingProcessID"
  
from "sap.fsdm::NonProportionalCoverageLimitDeductible"
FOR SYSTEM_TIME AS OF :I_SYSTEM_TIMESTAMP
WHERE "BusinessValidFrom" <= :I_BUSINESS_DATE AND "BusinessValidTo" > :I_BUSINESS_DATE;